<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        var x = 50, y = 50;
        var startX = 50, startY = 50;
        var canvas, ctx;
        var drawingMode = false;
        var color = 'red'

        function init() {
            canvas = document.getElementById('canvas');
            ctx = canvas.getContext('2d');
            drawBorder();
            drawSquare();

            document.addEventListener("keydown", move);
            updateCoords();
        }

        function drawBorder() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = 'black';
            ctx.strokeRect(0, 0, canvas.width, canvas.height);
        }

        function drawSquare() {
            ctx.fillStyle = color;
            ctx.fillRect(x, y, 20, 20);
        }

        function updateCoords() {
            document.getElementById("x").value = "x=" + x;
            document.getElementById("y").value = "y=" + y;
        }

        function move(event) {
            if (event.keyCode == "32") {
                drawingMode = !drawingMode;
                return;
            }

            if (event.keyCode == "27") {
                x = startX;
                y = startY;
                drawBorder();
                drawSquare();
                updateCoords();
                return;
            }

            if (event.keyCode == '49' || event.keyCode == '97') { color = 'red'; return; }
            if (event.keyCode == '50' || event.keyCode == '98') { color = 'blue'; return; }
            if (event.keyCode == '51' || event.keyCode == '99') { color = 'green'; return; }

            if (!drawingMode) {
                ctx.clearRect(x, y, 20, 20);
            }

            if (event.keyCode == 38) { y -= 5; }
            if (event.keyCode == 40) { y += 5; }
            if (event.keyCode == 39) { x += 5; }
            if (event.keyCode == 37) { x -= 5; }

            drawSquare();
            updateCoords();
        }
    </script>
</head>
<body onload="init();">
    <input type="text" id="x">
    <input type="text" id="y"><br>
    <canvas id="canvas" width="640" height="480"></canvas>
</body>
</html>